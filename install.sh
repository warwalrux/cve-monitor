#!/bin/bash

if [ -e "./cvemon.cfg" ]; then
    source ./cvemon.cfg
    if [ ! $CVEMON_DIR ]; then
        echo "Please set CVEMON_DIR in cvemon.cfg"
        exit 1
    fi
fi

if [ $(whoami) != "root" ]; then
    echo "Run cve-monitor service installation script as root"
    exit 1
else
    $(which pipenv) install
    ln -s $CVEMON_DIR/systemd-files/* /etc/systemd/system/
    systemctl daemon-reload
    systemctl start cve-monitor
fi
